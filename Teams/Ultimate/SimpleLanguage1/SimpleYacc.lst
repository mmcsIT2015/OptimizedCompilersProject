
// ==========================================================================
//  GPPG error listing for yacc source file <SimpleYacc.y>
// ==========================================================================
//  Version:  1.3.6
//  Machine:  IDEA-PC
//  DateTime: 18.09.2015 18:54:37
//  UserName: Michael
// ==========================================================================


%{
// Ýòè îáúÿâëåíèÿ äîáàâëÿþòñÿ â êëàññ GPPGParser, ïðåäñòàâëÿþùèé ñîáîé ïàðñåð, ãåíåðèðóåìûé ñèñòåìîé gppg
    public BlockNode root; // Êîðíåâîé óçåë ñèíòàêñè÷åñêîãî äåðåâà 
    public Parser(AbstractScanner<ValueType, LexLocation> scanner) : base(scanner) { }
%}

%output = SimpleYacc.cs

%union { 
			public double dVal; 
			public int iVal; 
			public string sVal; 
			public Node nVal;
			public ExprNode eVal;
			public StatementNode stVal;
			public BlockNode blVal;
//			public BinaryNode binVal;
       }

%using ProgramTree;

%namespace SimpleParser

%token CYCLE ASSIGN SEMICOLON PLUS MINUS DIV MULT LEFT_BR RIGHT_BR BEGIN END WHILE LARGER SMALLER
%token <iVal> INUM 
%token <dVal> RNUM 
%token <sVal> ID

%type <eVal> ident E
%type <stVal> assign statement cycle 
%type <blVal> stlist block
//%type <binVal> binExpr
%%
// Error: NonTerminal symbol "cond" has no productions
// Warning: Terminating cond fixes the following size-1 NonTerminal set
   // {cond}
// Error: There are 1 non-terminating NonTerminal Symbols
   //  {cond}
// --------------------------------------------------------------------

progr   : block { root = $1; }
		;

//binExpr : T operation F {$$ = new BinaryNode($1,$3,$2)}
//		;
		
//operation : PLUS
//			| MINUS
//			| MULT
//			| DIV
//		;
stlist	: statement 
			{ 
				$$ = new BlockNode($1); 
			}
		| stlist SEMICOLON statement 
			{ 
				$1.Add($3); 
				$$ = $1; 
			}
		;

statement: assign { $$ = $1; }
		| block   { $$ = $1; }
		| cycle   { $$ = $1; }
		| cond {$$ = $1; }
	;

ident 	: ID { $$ = new IdNode($1); }	
		;
	
assign 	: ident ASSIGN E{ $$ = new AssignNode($1 as IdNode, $3); }
		;

//expr : expr SMALLER E
//	| expr LARGER E
//	| E
//	;
	
E : T
     | E PLUS T
     | E MINUS T
     ;


T    : F
     | T MULT F
     | T DIV F 
     ;

F    : ident
     | INUM 
     | LEFT_BR E RIGHT_BR
     ;
	 
block	: BEGIN stlist END { $$ = $2; }
		;
	 

cycle	: CYCLE E statement { $$ = new CycleNode($2, $3); }
		;
	
%%

// ==========================================================================

