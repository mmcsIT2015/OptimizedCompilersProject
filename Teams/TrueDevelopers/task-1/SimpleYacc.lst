
// ==========================================================================
//  GPPG error listing for yacc source file <SimpleYacc.y>
// ==========================================================================
//  Version:  1.3.6
//  Machine:  DESKTOP-K6V2PJ2
//  DateTime: 20.09.2015 16:54:35
//  UserName: Alexey
// ==========================================================================


ï»¿%{
//-^^
// Error: This character is invalid in this context
// Error: This character is invalid in this context
// Error: This character is invalid in this context
// Error: Unknown %keyword in this context
// ------------------------------------------------
// Ð­ÑÐ¸ Ð¾Ð±ÑÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑÑÑÑ Ð² ÐºÐ»Ð°ÑÑ GPPGParser, Ð¿ÑÐµÐ´ÑÑÐ°Ð²Ð»ÑÑÑÐ¸Ð¹ ÑÐ¾Ð±Ð¾Ð¹ Ð¿Ð°ÑÑÐµÑ, Ð³ÐµÐ½ÐµÑÐ¸ÑÑÐµÐ¼ÑÐ¹ ÑÐ¸ÑÑÐµÐ¼Ð¾Ð¹ gppg
    public BlockNode root; // ÐÐ¾ÑÐ½ÐµÐ²Ð¾Ð¹ ÑÐ·ÐµÐ» ÑÐ¸Ð½ÑÐ°ÐºÑÐ¸ÑÐµÑÐºÐ¾Ð³Ð¾ Ð´ÐµÑÐµÐ²Ð°
//--^^^^^^
// Error: Syntax error, unexpected ident
// -------------------------------------
    public Parser(AbstractScanner<ValueType, LexLocation> scanner) : base(scanner) { }
//---------------^-----------------------------------------------^-------^
// Error: This character is invalid in this context
// Error: This character is invalid in this context
// Error: This character is invalid in this context
// Error: This character is invalid in this context
// ------------------------------------------------
%}

%output = SimpleYacc.cs

%union {
			public double dVal;
			public int iVal;
			public string sVal;
			public Node nVal;
			public ExprNode eVal;
			public StatementNode stVal;
			public BlockNode blVal;
			public CoutNode ioVal;
        }

%using ProgramTree;

%namespace SimpleParser

%token ASSIGN SEMICOLON PLUS MINUS MUL DIV LBRACKET RBRACKET BEGIN END IF ELSE WHILE DO LESS GREAT EQUAL INEQUAL LSHIFT COUT
%token <iVal> INUM
%token <dVal> RNUM
%token <sVal> ID

%type <eVal> expr ident T F S
%type <stVal> assign statement do_while while if
%type <blVal> stlist block
%type <ioVal> cout

%%

progr   : block { root = $1; }
		;

stlist	: statement { $$ = new BlockNode($1);	}
		| stlist SEMICOLON statement
			{
				$1.Add($3);
				$$ = $1;
			}
		;

cout	: COUT LSHIFT expr { $$ = new CoutNode($3); }
    | cout LSHIFT expr
    	{
    		$1.Add($3);
    		$$ = $1;
    	}
    ;

statement: assign { $$ = $1; }
    | block { $$ = $1; }
		| do_while { $$ = $1; }
		| while { $$ = $1; }
		| cout { $$ = $1; }
    | if { $$ = $1; }
    ;

ident 	: ID { $$ = new IdNode($1); }
		;

assign 	: ident ASSIGN expr { $$ = new AssignNode($1 as IdNode, $3); }
		;

expr : S { $$ = $1; }
    | expr LESS S { $$ = new BinaryNode($1, $3, BinaryOpType.Less); }
    | expr GREAT S { $$ = new BinaryNode($1, $3, BinaryOpType.More); }
    | expr EQUAL S { $$ = new BinaryNode($1, $3, BinaryOpType.Equal); }
    | expr INEQUAL S { $$ = new BinaryNode($1, $3, BinaryOpType.NotEqual); }
    ;

S : T { $$ = $1; }
    | S PLUS T { $$ = new BinaryNode($1, $3, BinaryOpType.Plus); }
    | S MINUS T { $$ = new BinaryNode($1, $3, BinaryOpType.Minus); }
    ;

T : F { $$ = $1; }
    | T MUL F { $$ = new BinaryNode($1, $3, BinaryOpType.Mult); }
    | T DIV F { $$ = new BinaryNode($1, $3, BinaryOpType.Div); }
    ;

F : ident { $$ = $1 as IdNode; }
    | INUM { $$ = new IntNumNode($1); }
    | LBRACKET expr RBRACKET { $$ = $2; }
    ;

if	: IF LBRACKET expr RBRACKET statement { $$ = new IfNode($3, $5); }
    | IF LBRACKET expr RBRACKET statement ELSE statement { $$ = new IfNode($3, $5, $7); }
    ;

block	: BEGIN stlist END { $$ = $2; }
		;

do_while	: DO statement WHILE LBRACKET expr RBRACKET SEMICOLON { $$ = new DoWhileNode($5, $2); }
		;

while	: WHILE LBRACKET expr RBRACKET statement { $$ = new WhileNode($3, $5); }
    ;

%%
// ==========================================================================

